<%
function formatNumberDisplay(value) {
    if (value === null || value === undefined || value === '') return '-';

    const num = parseFloat(value);
    if (isNaN(num)) return '-';

    if (num === 0) return '0';

    let result = '';
    
    if (Number.isInteger(num)) {
        result = num.toString();
    } else {
        const decimalStr = num.toString().split('.')[1];
        if (!decimalStr) {
            result = num.toString();
        } else if (decimalStr.length <= 2) {
            result = num.toString();
        } else {
            result = num.toFixed(3);
        }
    }

    // إذا كان الرقم سالب، أضف رمز اتجاه LTR قبل السالب لعرضه بشكل صحيح في RTL
    if (num < 0) {
        return '\u200E' + result;
    }

    return result;
}
%>

<div class="container-fluid mt-4">
    <div class="card shadow">
        <div class="card-body">
            <!-- Print Header using table layout -->
            <table style="width: 100%; border-collapse: collapse; font-family: 'Segoe UI', Tahoma, sans-serif; margin-bottom: 10px;">
                <tr>
                    <!-- Right side: المؤسسة -->
                    <td
                        style="text-align: right; direction: rtl; font-size: 10pt; font-weight: bold; color: #333; line-height: 1.4; width: 37%;">
                        <div>مؤسسة عجاج أخوان التجارية</div>
                        <div>لإنتاج وتعبئة المواد الغذائية</div>
                        <div>وتجارة زيت الزيتون البكر</div>
                        <div style="font-size: 12px;">س.ت 10369 – س.ص 10</div>
                    </td>

                    <!-- Center: الشعار -->
                    <td style="text-align: center; width: 26%;">
                        <img src="/public/images/nexa.png" alt="شعار" style="width: 100px; height: 100px;">
                    </td>

                    <!-- Left side: Company Information -->
                    <td
                        style="text-align: left; font-size: 10pt; font-weight: bold; color: #333; line-height: 1.4; width: 37%;">
                        <div>Ajaj Brothers Commercial Foundation</div>
                        <div>For Food Production and Packaging</div>
                        <div>And Virgin Olive Oil Trade</div>
                        <div style="font-size: 12px;">C.R. 10369 – I.R. 10</div>
                    </td>
                </tr>
            </table>
            <hr>

            <!-- Certificate Title in Center -->
            <div style="text-align: center; margin: 20px 0;">
                <div style="font-size: 12pt; font-weight: bold; color: #333; margin-bottom: 5px;">شهادة تحليل زيت زيتون رقم (<%= certificate.certificate_number %>)</div>
            </div>

            <!-- Customer and Certificate Info -->
            <div class="info-cards-container mb-3">
                <!-- Customer Info Card -->
                <div class="info-card customer-card">
                    <div class="info-card-header">
                        <h6 class="info-card-title">بيانات العميل/المورد</h6>
                    </div>
                    <div class="info-card-body">
                        <div class="info-row">
                            <span class="info-label">الاسم:</span>
                            <span class="info-value"><%= certificate.customer_name %></span>
                        </div>
                        <% if (certificate.customer_phone) { %>
                            <div class="info-row">
                                <span class="info-label">رقم الهاتف:</span>
                                <span class="info-value"><%= certificate.customer_phone %></span>
                            </div>
                        <% } %>
                        <% if (certificate.customer_address) { %>
                            <div class="info-row">
                                <span class="info-label">العنوان:</span>
                                <span class="info-value"><%= certificate.customer_address %></span>
                            </div>
                        <% } %>
                    </div>
                </div>

                <!-- Certificate Info Card -->
                <div class="info-card certificate-card">
                    <div class="info-card-header">
                        <h6 class="info-card-title">بيانات الشهادة</h6>
                    </div>
                    <div class="info-card-body">
                        <div class="info-row">
                            <span class="info-label">رقم الشهادة:</span>
                            <span class="info-value"><%= certificate.certificate_number %></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">التاريخ:</span>
                            <span class="info-value"><%= new Date(certificate.date).toLocaleDateString('en-GB', { year: 'numeric' , month: '2-digit' , day: '2-digit' }) %></span>
                        </div>
                        <% if (certificate.notes) { %>
                            <div class="info-row">
                                <span class="info-label">ملاحظات:</span>
                                <span class="info-value"><%= certificate.notes %></span>
                            </div>
                        <% } %>
                    </div>
                </div>
            </div>
            <br>
            <br>
            <!-- Main Table -->
            <div class="card mb-2 print-no-shadow" style="border: none;">
                <div class="card-body py-1 px-1">
                    <div class="table-responsive" style="overflow-x: auto;">
                        <table class="table-custom table-bordered text-center align-middle mb-0"
                            style="font-size: 9pt; width: 100%; direction: rtl;">
                            <thead>
                                <tr>
                                    <th style="width: 3%; padding: 6pt 4pt;">#</th>
                                    <th style="width: 6%; padding: 6pt 4pt;">الكمية</th>
                                    <th style="width: 7%; padding: 6pt 4pt;">وحدة تعبئة</th>
                                    <th style="width: 7%; padding: 6pt 4pt;">وزن تعبئة</th>
                                    <th style="width: 7%; padding: 6pt 4pt;">وزن إجمالي</th>
                                    <th style="width: 6%; padding: 6pt 4pt;">درجة الحموضة</th>
                                    <th style="width: 8%; padding: 6pt 4pt;">رقم البيروكسيد</th>
                                    <th style="width: 7%; padding: 6pt 4pt;">232</th>
                                    <th style="width: 7%; padding: 6pt 4pt;">266</th>
                                    <th style="width: 7%; padding: 6pt 4pt;">270</th>
                                    <th style="width: 7%; padding: 6pt 4pt;">274</th>
                                    <th style="width: 7%; padding: 6pt 4pt;">دلتا k</th>
                                    <th style="width: 7%; padding: 6pt 4pt;">ستيغما ستاديين</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% certificate.items.forEach(function(item, index) { %>
                                    <tr>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(index + 1) %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(item.quantity) %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= item.packaging_unit %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(item.packaging_weight) %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(item.total_weight) %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(item.ph) %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(item.peroxide) %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(item.abs_232) %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(item.abs_266) %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(item.abs_270) %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(item.abs_274) %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(item.delta_k) %>
                                        </td>
                                        <td style="padding: 4pt;">
                                            <%= formatNumberDisplay(item.stigmastadiene) %>
                                        </td>
                                    </tr>
                                    <% }); %>
                                    <tr>
                                        <td colspan="1" style="text-align: center; padding: 6pt 4pt;">
                                            <strong>المجموع</strong>
                                        </td>
                                        <td style="padding: 6pt 4pt;"><strong>
                                                <%= formatNumberDisplay(certificate.total_quantity) %>
                                            </strong></td>
                                        <td style="padding: 6pt 4pt;"></td>
                                        <td style="padding: 6pt 4pt;"></td>
                                        <td style="padding: 6pt 4pt;"><strong>
                                                <%= formatNumberDisplay(certificate.total_weight) %>
                                            </strong></td>
                                        <td colspan="8" style="padding: 6pt 4pt;"></td>
                                    </tr>
                                    <!-- المتوسط المرجح -->
                                    <tr style="background: #e9f7ef; font-weight: bold; border-top: 2px solid #198754;">
                                        <td colspan="5" style="text-align: center; padding: 6pt 4pt; vertical-align: middle;"><strong>المتوسط المرجح</strong></td>
                                        <td style="padding: 6pt 4pt; text-align: center; vertical-align: middle;"><strong><%= formatNumberDisplay(totalWeight ? (weightedPH / totalWeight) : 0) %></strong></td>
                                        <td style="padding: 6pt 4pt; text-align: center; vertical-align: middle;"><strong><%= formatNumberDisplay(totalWeight ? (weightedPeroxide / totalWeight) : 0) %></strong></td>
                                        <td style="padding: 6pt 4pt; text-align: center; vertical-align: middle;"><strong><%= formatNumberDisplay(totalWeight ? (weighted232 / totalWeight) : 0) %></strong></td>
                                        <td style="padding: 6pt 4pt; text-align: center; vertical-align: middle;"><strong><%= formatNumberDisplay(totalWeight ? (weighted266 / totalWeight) : 0) %></strong></td>
                                        <td style="padding: 6pt 4pt; text-align: center; vertical-align: middle;"><strong><%= formatNumberDisplay(totalWeight ? (weighted270 / totalWeight) : 0) %></strong></td>
                                        <td style="padding: 6pt 4pt; text-align: center; vertical-align: middle;"><strong><%= formatNumberDisplay(totalWeight ? (weighted274 / totalWeight) : 0) %></strong></td>
                                        <td style="padding: 6pt 4pt; text-align: center; vertical-align: middle;"><strong><%= formatNumberDisplay(totalWeight ? (weightedDeltaK / totalWeight) : 0) %></strong></td>
                                        <td style="padding: 6pt 4pt; text-align: center; vertical-align: middle;"><strong><%= formatNumberDisplay(totalWeight ? (weightedStigmastadiene / totalWeight) : 0) %></strong></td>
                                      </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- QR Code -->
            <div style="margin-top: 0.7cm; text-align: center;">
                <% if (typeof qrCode !=='undefined' && qrCode) { %>
                    <img src="<%= qrCode %>" alt="QR Code"
                        style="width: 110px; height: 110px; display: block; margin: 0 auto;">
                    <div style="font-size: 8.5pt; color: #666; margin-top: 6px; text-align: center;">
                        امسح الرمز لمشاهدة الشهادة إلكترونياً
                    </div>
                    <% } %>
            </div>

            <!-- Print Footer -->
            <div class="print-footer text-center" id="fixed-print-footer">
                <hr style="border-color: #ccc; margin: 4px 0;">
                سوريا، حماة، أوتستراد دمشق-حلب الدولي، س.ت 10369 – س.ص 10<br>
                0940500511 – 0988111127 | ajajbrothers@gmail.com<br>
                جميع الحقوق محفوظة © 2025 نظام إدارة المختبر | تم التطوير بواسطة شركة NEXA GROUP COMPANY
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const printButton = document.querySelector('.print-button');
    if (printButton) {
        printButton.addEventListener('click', function() {
            window.print();
        });
    }
});
</script>

<style>
/* Screen Styles */
.table-responsive {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch; /* تحسين السكرول في iOS */
    scrollbar-width: thin; /* Firefox */
    scrollbar-color: #888 #f1f1f1; /* Firefox */
    position: relative;
}

.table-responsive::-webkit-scrollbar {
    height: 8px; /* ارتفاع السكرول بار */
}

.table-responsive::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}

.table-responsive::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
}

.table-responsive::-webkit-scrollbar-thumb:hover {
    background: #555;
}

.table-custom {
    min-width: 1200px; /* عرض أدنى للجدول */
    width: 100%;
}

.table-custom th, 
.table-custom td {
    white-space: nowrap;
    min-width: 80px;
    padding: 8px 4px;
    font-size: 0.875rem;
}

/* تحسين عرض الجدول في الشاشات الصغيرة */
@media (max-width: 1200px) {
    .table-custom {
        min-width: 1000px;
    }
    
    .table-custom th, 
    .table-custom td {
        font-size: 0.8rem;
        padding: 6px 3px;
    }
}

@media (max-width: 768px) {
    .container-fluid {
        padding: 0.5rem;
    }
    
    .card-body {
        padding: 0.5rem;
    }
    
    .table-custom {
        min-width: 900px;
    }
    
    .table-custom th, 
    .table-custom td {
        font-size: 0.75rem;
        padding: 4px 2px;
        min-width: 70px;
    }
    
    /* تحسين عرض النص في الخلايا */
    .table-custom th,
    .table-custom td {
        text-overflow: ellipsis;
        overflow: hidden;
        max-width: 80px;
    }
    
    /* إضافة مؤشر للسكرول */
    .table-responsive::after {
        content: "← اسحب للتنقل →";
        display: block;
        text-align: center;
        padding: 8px;
        background: #f8f9fa;
        color: #6c757d;
        font-size: 0.8rem;
        border-top: 1px solid #dee2e6;
    }
    
    /* تحسين العناوين للشاشات الصغيرة */
    .card-body h6 {
        font-size: 0.9rem;
    }
    
    .card-body p {
        font-size: 0.8rem;
        margin: 0.25rem 0;
    }
    
    /* تحسين عنوان الشهادة */
    .card-body > div[style*="text-align: center"] {
        margin: 15px 0;
    }
    
    .card-body > div[style*="text-align: center"] div {
        font-size: 1rem;
    }
}

@media (max-width: 576px) {
    .container-fluid {
        padding: 0.25rem;
    }
    
    .card-body {
        padding: 0.25rem;
    }
    
    .table-custom {
        min-width: 800px;
    }
    
    .table-custom th, 
    .table-custom td {
        font-size: 0.7rem;
        padding: 3px 1px;
        min-width: 60px;
    }
    
    /* تحسين العناوين للشاشات الصغيرة جداً */
    .card-body h6 {
        font-size: 0.8rem;
    }
    
    .card-body p {
        font-size: 0.75rem;
        margin: 0.2rem 0;
    }
    
    /* تحسين عنوان الشهادة */
    .card-body > div[style*="text-align: center"] div {
        font-size: 0.9rem;
    }
    
    /* تحسين الجدول المعلوماتي */
    .table-custom.table-bordered[style*="direction: rtl"] {
        font-size: 0.7rem;
    }
    
    .table-custom.table-bordered[style*="direction: rtl"] td {
        padding: 4pt;
    }
}

@media (max-width: 480px) {
    .table-custom {
        min-width: 750px;
    }
    
    .table-custom th, 
    .table-custom td {
        font-size: 0.65rem;
        padding: 2px 1px;
        min-width: 55px;
    }
    
    /* تحسين مؤشر السكرول */
    .table-responsive::after {
        content: "← اسحب →";
        font-size: 0.7rem;
        padding: 6px;
    }
}

/* تحسينات إضافية للموبايل */
@media (max-width: 768px) {
    /* تحسين التفاعل باللمس */
    .table-custom th,
    .table-custom td {
        -webkit-tap-highlight-color: rgba(0,0,0,0.1);
        touch-action: pan-x;
    }
    
    /* تحسين مظهر السكرول */
    .table-responsive {
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    /* تحسين مظهر الجدول */
    .table-custom {
        border-radius: 6px;
        overflow: hidden;
    }
    
    /* تحسين مظهر العناوين */
    .table-custom th {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-bottom: 2px solid #dee2e6;
        font-weight: 600;
    }
    
    /* تحسين مظهر الصفوف */
    .table-custom tbody tr:nth-child(even) {
        background-color: rgba(0,0,0,0.02);
    }
    
    .table-custom tbody tr:hover {
        background-color: rgba(0,0,0,0.05);
    }
    
    /* تحسين مظهر صف المتوسط المرجح */
    .table-custom tbody tr[style*="background: #e9f7ef"] {
        background: linear-gradient(135deg, #e9f7ef 0%, #d1f2d1 100%) !important;
        border-top: 2px solid #198754;
    }
}

/* تحسينات للشاشات الصغيرة جداً */
@media (max-width: 480px) {
    /* تقليل المسافات */
    .card-body {
        padding: 0.15rem;
    }
    
    /* تحسين مظهر الجدول المعلوماتي */
    .table-custom.table-bordered[style*="direction: rtl"] {
        margin-bottom: 0.5rem;
    }
    
    /* تحسين مظهر QR Code */
    .card-body > div[style*="text-align: center"] img {
        width: 80px !important;
        height: 80px !important;
    }
    
    .card-body > div[style*="text-align: center"] div {
        font-size: 0.7rem !important;
    }
    
    /* تحسين مظهر Footer */
    .print-footer {
        font-size: 0.6rem !important;
        line-height: 1.2 !important;
    }
}

/* تحسينات قسم معلومات العميل والشهادة - Cards Design */
.info-cards-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1rem;
}

.info-card {
    background: white;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    overflow: hidden;
}

.info-card-header {
    background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
    padding: 8pt;
    border-bottom: 1px solid #dee2e6;
}

.info-card-title {
    font-size: 10pt;
    font-weight: bold;
    color: white;
    margin: 0;
    text-align: center;
}

.info-card-body {
    padding: 8pt;
}

.info-row {
    display: flex;
    flex-direction: column;
    margin-bottom: 6pt;
    padding: 4pt;
    background: rgba(248, 249, 250, 0.5);
    border-radius: 4px;
    border-right: 3px solid #3498db;
}

.info-label {
    font-weight: bold;
    color: #34495e;
    font-size: 8pt;
    margin-bottom: 2pt;
}

.info-value {
    color: #2c3e50;
    font-size: 9pt;
    word-break: break-word;
    line-height: 1.3;
}

/* تحسينات الموبايل للـ Cards */
@media (max-width: 768px) {
    .info-cards-container {
        grid-template-columns: 1fr;
        gap: 0.75rem;
    }
    
    .info-card-title {
        font-size: 9pt;
    }
    
    .info-card-body {
        padding: 6pt;
    }
    
    .info-row {
        margin-bottom: 4pt;
        padding: 3pt;
    }
    
    .info-label {
        font-size: 7pt;
    }
    
    .info-value {
        font-size: 8pt;
    }
}

@media (max-width: 576px) {
    .info-cards-container {
        gap: 0.5rem;
    }
    
    .info-card-title {
        font-size: 8pt;
    }
    
    .info-card-body {
        padding: 4pt;
    }
    
    .info-row {
        margin-bottom: 3pt;
        padding: 2pt;
    }
    
    .info-label {
        font-size: 6pt;
    }
    
    .info-value {
        font-size: 7pt;
    }
}

@media (max-width: 480px) {
    .info-cards-container {
        gap: 0.25rem;
    }
    
    .info-card {
        border-radius: 6px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .info-card-title {
        font-size: 7pt;
    }
    
    .info-card-body {
        padding: 3pt;
    }
    
    .info-row {
        margin-bottom: 2pt;
        padding: 2pt;
    }
    
    .info-label {
        font-size: 5pt;
    }
    
    .info-value {
        font-size: 6pt;
    }
}

/* تحسينات الموبايل لقسم المعلومات */
@media (max-width: 768px) {
    .info-table {
        font-size: 8pt !important;
    }
    
    .info-section-title {
        font-size: 9pt !important;
        margin-bottom: 6pt !important;
    }
    
    .info-item {
        margin-bottom: 4pt !important;
        padding: 3pt !important;
    }
    
    .info-label {
        font-size: 7pt !important;
    }
    
    .info-value {
        font-size: 8pt !important;
    }
    


/* تحسينات للطباعة */
@media print {
    .info-cards-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0.5cm;
        margin-bottom: 0.5cm;
    }
    
    .info-card {
        border-radius: 0;
        box-shadow: none;
        border: 1px solid #000;
        page-break-inside: avoid;
    }
    
    .info-card-header {
        background: #f5f5f5 !important;
        border-bottom: 1px solid #000;
    }
    
    .info-card-title {
        color: #000 !important;
        font-size: 9pt !important;
    }
    
    .info-row {
        background: transparent !important;
        border-right: 1px solid #000 !important;
    }
    
    .info-label {
        color: #000 !important;
    }
    
    .info-value {
        color: #000 !important;
    }
}

/* إضافة خطوط عربية للويب أيضاً */
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&family=Amiri:wght@400;500;600;700&display=swap');

/* Print Styles */
@media print {
    @page {
        size: A4 portrait;
        margin: 0.5cm;
    }

    html,
    body {
        background: white !important;
        margin: 0 !important;
        padding: 0 !important;
        direction: rtl;
        text-align: right;
        font-family: 'Cairo', 'Amiri', 'Noto Naskh Arabic', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
        font-size: 10pt;
        font-weight: 500 !important;
        -webkit-font-smoothing: antialiased !important;
        -moz-osx-font-smoothing: grayscale !important;
    }

    /* تحسين الخط العربي للعناوين */
    h1, h2, h3, h4, h5, h6, th, strong {
        font-family: 'Cairo', 'Amiri', 'Noto Naskh Arabic', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
        font-weight: 700 !important;
        -webkit-font-smoothing: antialiased !important;
        -moz-osx-font-smoothing: grayscale !important;
    }

    .table-responsive {
        overflow-x: visible !important;
    }

    .table-custom {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        margin-bottom: 0.5cm;
        direction: rtl;
        font-family: 'Cairo', 'Amiri', 'Noto Naskh Arabic', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
        font-weight: 500 !important;
    }

    .table-custom th,
    .table-custom td {
        border: 1px solid #444 !important;
        padding: 6pt 4pt !important;
        background-clip: padding-box;
        font-family: 'Cairo', 'Amiri', 'Noto Naskh Arabic', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
        font-weight: 500 !important;
        -webkit-font-smoothing: antialiased !important;
        -moz-osx-font-smoothing: grayscale !important;
    }

    .table-custom th {
        background-color: #f5f5f5 !important;
        font-weight: 700 !important;
        font-size: 9pt !important;
    }

    .table-custom {
        border: 1px solid #666 !important;
        border-radius: 6px;
        overflow: hidden;
    }

    thead {
        display: table-header-group;
    }

    tfoot {
        display: table-footer-group;
    }

    tr {
        page-break-inside: avoid;
    }

    .container {
        padding: 0 !important;
        margin: 0 !important;
        max-width: none !important;
    }

    .card-body {
        padding: 0 !important;
    }

    .print-header,
    .print-footer,
    .print-signatures {
        display: block !important;
        font-family: 'Cairo', 'Amiri', 'Noto Naskh Arabic', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
        font-weight: 500 !important;
    }

    .d-print-none {
        display: none !important;
    }

    .signature-line {
        border-top: 1px solid #000;
        width: 70%;
        margin: 0.7cm auto 0.2cm auto;
        height: 1px;
    }

    .print-header hr {
        margin: 2px 0 6px 0;
        border: 0.5px solid #bbb;
    }

    .print-no-shadow {
        box-shadow: none !important;
    }

    .website-footer {
        display: none !important;
    }

    body.printing {
        visibility: visible !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }

    .table-custom {
        width: 100% !important;
        margin: 0 !important;
        page-break-inside: auto !important;
    }

    /* تحسين مظهر النصوص العربية */
    p, div, span {
        font-family: 'Cairo', 'Amiri', 'Noto Naskh Arabic', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
        font-weight: 500 !important;
        -webkit-font-smoothing: antialiased !important;
        -moz-osx-font-smoothing: grayscale !important;
    }

    /* تحسين مظهر الأرقام */
    .formatNumberDisplay {
        font-family: 'Cairo', 'Amiri', 'Noto Naskh Arabic', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
        font-weight: 600 !important;
    }

    /* تحسين وضوح الخطوط في الطباعة */
    * {
        text-rendering: optimizeLegibility !important;
        -webkit-font-feature-settings: "liga" 1, "kern" 1 !important;
        font-feature-settings: "liga" 1, "kern" 1 !important;
    }

    .container-fluid {
        padding: 0.2cm !important;
        margin: 0 !important;
    }

    .card-body {
        padding: 0.2cm !important;
    }

    /* Print Header */
    .print-header {
        padding-bottom: 0.3cm !important;
        margin-bottom: 0.3cm !important;
    }

    .print-header h3 {
        font-size: 14pt !important;
        margin-bottom: 3pt !important;
    }

    .print-header h4 {
        font-size: 12pt !important;
        margin-bottom: 3pt !important;
    }

    .print-header p {
        font-size: 8pt !important;
        margin: 1pt 0 !important;
    }

    /* Info Table */
    .info-table {
        margin-bottom: 0.3cm !important;
    }

    .info-table td {
        padding: 3pt !important;
    }

    .info-table h6 {
        font-size: 8pt !important;
        margin-bottom: 2pt !important;
    }

    .info-table p {
        font-size: 7pt !important;
        margin-bottom: 1pt !important;
    }

    /* Main Table */
    .table-responsive {
        margin: 0 !important;
        padding: 0 !important;
    }

    .table {
        margin: 0 !important;
        font-size: 7pt !important;
        line-height: 1.1 !important;
    }

    .table th {
        padding: 2pt 1pt !important;
        font-size: 7pt !important;
    }

    .table td {
        padding: 2pt 1pt !important;
        font-size: 7pt !important;
    }

    /* Column Widths */
    .table th:nth-child(1), .table td:nth-child(1) { width: 5% !important; } /* رقم العينة */
    .table th:nth-child(2), .table td:nth-child(2) { width: 5% !important; } /* الكمية */
    .table th:nth-child(3), .table td:nth-child(3) { width: 7% !important; } /* وحدة تعبئة */
    .table th:nth-child(4), .table td:nth-child(4) { width: 7% !important; } /* وزن تعبئة */
    .table th:nth-child(5), .table td:nth-child(5) { width: 7% !important; } /* وزن إجمالي */
    .table th:nth-child(6), .table td:nth-child(6) { width: 9% !important; } /* درجة حموضة */
    .table th:nth-child(7), .table td:nth-child(7) { width: 10% !important; } /* رقم البيروكسيد */
    .table th:nth-child(8), .table td:nth-child(8) { width: 10% !important; } /* وزن العينة */
    .table th:nth-child(9), .table td:nth-child(9) { width: 8% !important; } /* 232 */
    .table th:nth-child(10), .table td:nth-child(10) { width: 8% !important; } /* 270 */
    .table th:nth-child(11), .table td:nth-child(11) { width: 8% !important; } /* دلتا k */
    .table th:nth-child(12), .table td:nth-child(12) { width: 8% !important; } /* 274 */
    .table th:nth-child(13), .table td:nth-child(13) { width: 8% !important; } /* ستيغما ستاديين */

    /* Signatures Section */
    .row.mb-3 {
        margin-top: 0.3cm !important;
        margin-bottom: 0.3cm !important;
        font-size: 8pt !important;
    }

    /* Footer */
    .print-footer {
        margin-top: 0.3cm !important;
        font-size: 7pt !important;
    }

    .print-footer hr {
        margin: 2pt 0 !important;
    }
}
</style> 